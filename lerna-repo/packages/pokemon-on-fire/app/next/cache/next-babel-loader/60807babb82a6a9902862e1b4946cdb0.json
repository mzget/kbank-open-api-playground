{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport { fetch } from \"cross-fetch\";\nconst apikey = \"pkey_prod_5BpmBr5LpqG84jYnDLPQe3Zv1OuhdN5dg\"; // https://dev-kpaymentgateway-services.kasikornbank.com/card/v2/charge\n\nlet url = \"\";\n\nasync function Checkout(req, res) {\n  let {\n    method\n  } = req;\n  let body = req.body;\n\n  switch (method) {\n    case \"POST\":\n      try {\n        let data = {\n          token: body.token,\n          saveCard: body.saveCard,\n          source_type: body.paymentMethods,\n          amount: body.amount,\n          currency: body.currency,\n          mode: \"token\",\n          reference_order: \"test123\"\n        };\n        const resp = await fetch(url, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"Cache-Control\": \"no-cache\",\n            \"x-api-key\": apikey\n          },\n          body: _JSON$stringify(data)\n        });\n\n        if (resp.ok) {\n          const result = await resp.json();\n          res.status(200).json(result);\n        } else {\n          const result = await resp.json();\n          throw new Error(_JSON$stringify(result));\n        }\n      } catch (ex) {\n        res.status(400).json({\n          status: \"Bad Request\",\n          message: ex.message\n        });\n      }\n\n      break;\n\n    default:\n      res.setHeader(\"Allow\", [\"GET\", \"POST\"]);\n      res.status(405).end(`Method ${method} Not Allowed`);\n  }\n}\n\nexport default Checkout;","map":null,"metadata":{},"sourceType":"module"}